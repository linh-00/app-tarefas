<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lista de Tarefas</title>
    <link rel="stylesheet" href="style.css">
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
</head>
<body>
    <!-- Tela de Login -->
    <div class="container" id="loginScreen">
        <h1>ğŸ”’ Login - Minhas Tarefas</h1>
        
        <div class="login-form">
            <input 
                type="text" 
                id="loginUsername" 
                placeholder="UsuÃ¡rio"
                class="login-input">
            <input 
                type="password" 
                id="loginPassword" 
                placeholder="Senha"
                class="login-input"
                onkeypress="if(event.key === 'Enter') login()">
            <button onclick="login()" class="login-btn">Entrar</button>
            <button onclick="showRegister()" class="register-btn">Criar Conta</button>
        </div>
    </div>

    <!-- Tela de Registro -->
    <div class="container" id="registerScreen" style="display: none;">
        <h1>ğŸ”‘ Criar Conta</h1>
        
        <div class="login-form">
            <input 
                type="text" 
                id="registerUsername" 
                placeholder="UsuÃ¡rio"
                class="login-input">
            <input 
                type="password" 
                id="registerPassword" 
                placeholder="Senha"
                class="login-input">
            <input 
                type="password" 
                id="registerPasswordConfirm" 
                placeholder="Confirmar Senha"
                class="login-input"
                onkeypress="if(event.key === 'Enter') register()">
            <button onclick="register()" class="login-btn">Criar Conta</button>
            <button onclick="showLogin()" class="register-btn">Voltar ao Login</button>
        </div>
    </div>

    <!-- Tela Principal -->
    <div class="container" id="mainScreen" style="display: none;">
        <div class="header-with-logout">
            <h1>ğŸ“ Minhas Tarefas</h1>
            <button onclick="logout()" class="logout-btn">Sair</button>
        </div>
        
        <div class="current-time-display">
            <div id="currentDateTime" class="date-time-text"></div>
        </div>
        
        <div class="folder-section">
            <div class="input-container">
                <input 
                    type="text" 
                    id="folderInput" 
                    placeholder="Nome da pasta..."
                    onkeypress="if(event.key === 'Enter') addFolder()">
                <button onclick="addFolder()">ğŸ“ Criar Pasta</button>
            </div>
        </div>

        <div class="loose-tasks-section">
            <h2>ğŸ“‹ Tarefas Soltas</h2>
            <div class="task-form">
                <input 
                    type="text" 
                    id="taskTitle" 
                    placeholder="TÃ­tulo da tarefa..."
                    class="task-title-input">
                <textarea 
                    id="taskDescription" 
                    placeholder="DescriÃ§Ã£o (opcional)..."
                    class="task-description-input"
                    rows="2"></textarea>
                <div class="task-extra-fields">
                    <label class="checkbox-label">
                        <input type="checkbox" id="taskIsToday">
                        <span>â­ Tarefa do dia</span>
                    </label>
                    <label class="difficulty-label">
                        <span>ğŸ¯ Dificuldade:</span>
                        <select id="taskDifficulty" class="difficulty-select">
                            <option value="1">1 - Muito FÃ¡cil</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5" selected>5 - MÃ©dia</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10 - Muito DifÃ­cil</option>
                        </select>
                    </label>
                </div>
                <button onclick="addLooseTask()">+ Adicionar Tarefa</button>
            </div>
            <ul id="looseTasksList" class="task-drop-zone"
                ondragover="handleDragOver(event)"
                ondragleave="handleDragLeave(event)"
                ondrop="handleDrop(event, 'loose')"></ul>
        </div>

        <div class="today-tasks-card" onclick="openTodayTasks()">
            <div class="today-card-icon">â­</div>
            <div class="today-card-content">
                <h3>Tarefas do Dia</h3>
                <p id="todayTaskCount">0 tarefas</p>
            </div>
        </div>

        <div class="today-tasks-card" onclick="openKanbanBoard()" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
            <div class="today-card-icon">ğŸ“Š</div>
            <div class="today-card-content">
                <h3>Quadro Kanban</h3>
                <p id="kanbanTaskCount">0 tarefas em fluxo</p>
            </div>
        </div>

        <div class="today-tasks-card" onclick="openDashboard()" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
            <div class="today-card-icon">ğŸ“ˆ</div>
            <div class="today-card-content">
                <h3>Dashboard</h3>
                <p>MÃ©tricas e rendimento</p>
            </div>
        </div>

        <div id="foldersContainer"></div>
    </div>

    <!-- Tela da Pasta -->
    <div class="container" id="folderScreen" style="display: none;">
        <div class="folder-header-screen">
            <button class="back-btn" onclick="goBackToMain()">â† Voltar</button>
            <h1 id="folderScreenTitle">ğŸ“ Pasta</h1>
        </div>

        <div class="folder-content">
            <div class="task-form">
                <input 
                    type="text" 
                    id="folderScreenTaskTitle" 
                    placeholder="TÃ­tulo da tarefa..."
                    class="task-title-input">
                <textarea 
                    id="folderScreenTaskDescription" 
                    placeholder="DescriÃ§Ã£o (opcional)..."
                    class="task-description-input"
                    rows="2"></textarea>
                <div class="task-extra-fields">
                    <label class="checkbox-label">
                        <input type="checkbox" id="folderScreenTaskIsToday">
                        <span>â­ Tarefa do dia</span>
                    </label>
                    <label class="difficulty-label">
                        <span>ğŸ¯ Dificuldade:</span>
                        <select id="folderScreenTaskDifficulty" class="difficulty-select">
                            <option value="1">1 - Muito FÃ¡cil</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5" selected>5 - MÃ©dia</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10 - Muito DifÃ­cil</option>
                        </select>
                    </label>
                </div>
                <button onclick="addTaskToCurrentFolder()">+ Adicionar Tarefa</button>
            </div>

            <ul id="folderScreenTasksList"></ul>
        </div>
    </div>

    <!-- Tela de VisualizaÃ§Ã£o da Tarefa -->
    <div class="container" id="taskViewScreen" style="display: none;">
        <div class="folder-header-screen">
            <button class="back-btn" onclick="goBackToFolder()">â† Voltar</button>
            <h1 id="taskViewTitle">ğŸ“‹ Tarefa</h1>
        </div>

        <div class="task-view-content">
            <div class="task-view-header">
                <h2 id="taskViewTitleText"></h2>
                <div class="task-view-actions">
                    <button id="taskViewCompleteBtn" class="complete-btn" onclick="toggleCurrentTask()">Concluir</button>
                    <button class="delete-btn" onclick="deleteCurrentTask()">Excluir Tarefa</button>
                </div>
            </div>
            
            <div class="task-view-meta">
                <span id="taskViewDifficulty" class="difficulty-badge"></span>
                <span id="taskViewTodayBadge" class="today-badge" style="display: none;">â­ Tarefa do Dia</span>
            </div>
            
            <div class="task-view-options">
                <label class="checkbox-label">
                    <input type="checkbox" id="taskViewIsToday" onchange="updateTaskIsToday()">
                    <span>â­ Marcar como Tarefa do Dia</span>
                </label>
                <label class="difficulty-label">
                    <span>ğŸ¯ Dificuldade:</span>
                    <select id="taskViewDifficultySelect" class="difficulty-select" onchange="updateTaskDifficulty()">
                        <option value="1">1 - Muito FÃ¡cil</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5 - MÃ©dia</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                        <option value="8">8</option>
                        <option value="9">9</option>
                        <option value="10">10 - Muito DifÃ­cil</option>
                    </select>
                </label>
                <label class="difficulty-label">
                    <span>ğŸ“Š Status:</span>
                    <select id="taskViewStatus" class="difficulty-select" onchange="updateTaskViewStatus()">
                        <option value="pending">ğŸ“‹ Pendente</option>
                        <option value="awaiting_approval">â³ Aguardando AprovaÃ§Ã£o</option>
                        <option value="approved">âœ… AlteraÃ§Ã£o Aprovada</option>
                        <option value="completed">ğŸ‰ ConcluÃ­da</option>
                    </select>
                </label>
            </div>
            
            <div class="task-view-description">
                <h3>DescriÃ§Ã£o:</h3>
                <p id="taskViewDescriptionText"></p>
            </div>
            
            <div class="task-view-observations">
                <h3>ğŸ“ Nova ObservaÃ§Ã£o:</h3>
                <textarea 
                    id="taskViewObservations" 
                    placeholder="Digite aqui uma nova observaÃ§Ã£o sobre o progresso da tarefa..."
                    class="observations-textarea"></textarea>
                <button onclick="saveObservations()" class="save-obs-btn">Salvar ObservaÃ§Ã£o</button>
                
                <h3 style="margin-top: 20px;">ğŸ’¬ ComentÃ¡rios Anteriores:</h3>
                <div id="taskViewCommentsList" style="max-height: 200px; overflow-y: auto;"></div>
            </div>
        </div>
    </div>

    <!-- Tela Dashboard -->
    <div class="container" id="dashboardScreen" style="display: none;">
        <div class="folder-header-screen">
            <button class="back-btn" onclick="goBackToMain()">â† Voltar</button>
            <h1>ğŸ“ˆ Dashboard - MÃ©tricas e Rendimento</h1>
        </div>

        <!-- Filtros -->
        <div class="dashboard-filters">
            <label class="filter-label">
                <span>ğŸ“ Filtrar por:</span>
                <select id="dashboardFilter" class="dashboard-select" onchange="renderDashboard()">
                    <option value="all">Todas as Tarefas</option>
                    <option value="loose">Tarefas Soltas</option>
                </select>
            </label>
        </div>

        <!-- MÃ©tricas de Rendimento -->
        <div class="metrics-container">
            <div class="metric-card">
                <div class="metric-icon">ğŸ“…</div>
                <div class="metric-content">
                    <h3>Hoje</h3>
                    <p id="metricToday" class="metric-value">0</p>
                    <span class="metric-label">tarefas concluÃ­das</span>
                </div>
            </div>
            
            <div class="metric-card">
                <div class="metric-icon">ğŸ“Š</div>
                <div class="metric-content">
                    <h3>Esta Semana</h3>
                    <p id="metricWeek" class="metric-value">0</p>
                    <span class="metric-label">tarefas concluÃ­das</span>
                </div>
            </div>
            
            <div class="metric-card">
                <div class="metric-icon">â­</div>
                <div class="metric-content">
                    <h3>MÃ©dia DiÃ¡ria</h3>
                    <p id="metricAverage" class="metric-value">0</p>
                    <span class="metric-label">tarefas/dia</span>
                </div>
            </div>
            
            <div class="metric-card">
                <div class="metric-icon">ğŸ¯</div>
                <div class="metric-content">
                    <h3>Total Geral</h3>
                    <p id="metricTotal" class="metric-value">0</p>
                    <span class="metric-label">tarefas cadastradas</span>
                </div>
            </div>
        </div>

        <!-- GrÃ¡fico de Etapas (PrÃ©dio) -->
        <div class="chart-section">
            <h2>ğŸ“Š Tarefas por Etapa</h2>
            <div class="building-chart" id="buildingChart">
                <div class="chart-column">
                    <div class="chart-bar" id="barPending" data-count="0" style="background: #6c757d;">
                        <span class="bar-count">0</span>
                    </div>
                    <div class="chart-label">ğŸ“‹ Pendente</div>
                </div>
                
                <div class="chart-column">
                    <div class="chart-bar" id="barAwaiting" data-count="0" style="background: #ffc107;">
                        <span class="bar-count">0</span>
                    </div>
                    <div class="chart-label">â³ Aguardando</div>
                </div>
                
                <div class="chart-column">
                    <div class="chart-bar" id="barApproved" data-count="0" style="background: #17a2b8;">
                        <span class="bar-count">0</span>
                    </div>
                    <div class="chart-label">âœ… Aprovada</div>
                </div>
                
                <div class="chart-column">
                    <div class="chart-bar" id="barCompleted" data-count="0" style="background: #28a745;">
                        <span class="bar-count">0</span>
                    </div>
                    <div class="chart-label">ğŸ‰ ConcluÃ­da</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tela Kanban -->
    <div class="container" id="kanbanScreen" style="display: none;">
        <div class="folder-header-screen">
            <button class="back-btn" onclick="goBackToMain()">â† Voltar</button>
            <h1>ğŸ“Š Quadro Kanban</h1>
        </div>

        <div class="kanban-board">
            <div class="kanban-column">
                <div class="kanban-column-header" style="background: #6c757d;">
                    <h3>ğŸ“‹ Pendente</h3>
                    <span class="kanban-count" id="pendingCount">0</span>
                </div>
                <div class="kanban-column-content" 
                     id="pendingColumn"
                     data-status="pending"
                     ondragover="handleKanbanDragOver(event)"
                     ondragleave="handleKanbanDragLeave(event)"
                     ondrop="handleKanbanDrop(event, 'pending')">
                </div>
            </div>

            <div class="kanban-column">
                <div class="kanban-column-header" style="background: #ffc107;">
                    <h3>â³ Aguardando AprovaÃ§Ã£o</h3>
                    <span class="kanban-count" id="awaitingCount">0</span>
                </div>
                <div class="kanban-column-content" 
                     id="awaitingColumn"
                     data-status="awaiting_approval"
                     ondragover="handleKanbanDragOver(event)"
                     ondragleave="handleKanbanDragLeave(event)"
                     ondrop="handleKanbanDrop(event, 'awaiting_approval')">
                </div>
            </div>

            <div class="kanban-column">
                <div class="kanban-column-header" style="background: #17a2b8;">
                    <h3>âœ… AlteraÃ§Ã£o Aprovada</h3>
                    <span class="kanban-count" id="approvedCount">0</span>
                </div>
                <div class="kanban-column-content" 
                     id="approvedColumn"
                     data-status="approved"
                     ondragover="handleKanbanDragOver(event)"
                     ondragleave="handleKanbanDragLeave(event)"
                     ondrop="handleKanbanDrop(event, 'approved')">
                </div>
            </div>

            <div class="kanban-column">
                <div class="kanban-column-header" style="background: #28a745;">
                    <h3>ğŸ‰ ConcluÃ­da</h3>
                    <span class="kanban-count" id="completedCount">0</span>
                </div>
                <div class="kanban-column-content" 
                     id="completedColumn"
                     data-status="completed"
                     ondragover="handleKanbanDragOver(event)"
                     ondragleave="handleKanbanDragLeave(event)"
                     ondrop="handleKanbanDrop(event, 'completed')">
                </div>
            </div>
        </div>
    </div>

    <!-- Tela de Tarefas do Dia -->
    <div class="container" id="todayTasksScreen" style="display: none;">
        <div class="folder-header-screen">
            <button class="back-btn" onclick="goBackToMain()">â† Voltar</button>
            <h1>â­ Tarefas do Dia</h1>
        </div>

        <div class="today-tasks-grid" id="todayTasksGrid"></div>
    </div>

    <!-- Modal de Tarefa do Dia -->
    <div id="todayTaskModal" class="modal">
        <div class="modal-content modal-large">
            <span class="close" onclick="closeTodayTaskModal()">&times;</span>
            <div class="modal-header">
                <h2 id="todayModalTitle"></h2>
                <div id="todayModalBadges"></div>
            </div>
            
            <div class="modal-folder" id="todayModalFolder"></div>
            
            <div class="modal-section">
                <h3>DescriÃ§Ã£o:</h3>
                <p id="todayModalDescription"></p>
            </div>
            
            <div class="modal-section">
                <label class="checkbox-label">
                    <input type="checkbox" id="todayModalIsToday" onchange="updateTodayTaskIsToday()">
                    <span>â­ Tarefa do dia</span>
                </label>
                <label class="difficulty-label">
                    <span>ğŸ¯ Dificuldade:</span>
                    <select id="todayModalDifficulty" class="difficulty-select" onchange="updateTodayTaskDifficulty()">
                        <option value="1">1 - Muito FÃ¡cil</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5 - MÃ©dia</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                        <option value="8">8</option>
                        <option value="9">9</option>
                        <option value="10">10 - Muito DifÃ­cil</option>
                    </select>
                </label>
                <label class="difficulty-label">
                    <span>ğŸ“Š Status:</span>
                    <select id="todayModalStatus" class="difficulty-select" onchange="updateTodayTaskStatus()">
                        <option value="pending">ğŸ“‹ Pendente</option>
                        <option value="awaiting_approval">â³ Aguardando AprovaÃ§Ã£o</option>
                        <option value="approved">âœ… AlteraÃ§Ã£o Aprovada</option>
                        <option value="completed">ğŸ‰ ConcluÃ­da</option>
                    </select>
                </label>
            </div>
            
            <div class="modal-section">
                <h3>ğŸ“ Nova ObservaÃ§Ã£o:</h3>
                <textarea 
                    id="todayModalObservations" 
                    placeholder="Digite aqui uma nova observaÃ§Ã£o sobre o progresso da tarefa..."
                    class="observations-textarea"></textarea>
                <button onclick="saveTodayObservations()" class="save-obs-btn">Salvar ObservaÃ§Ã£o</button>
                
                <h3 style="margin-top: 20px;">ğŸ’¬ ComentÃ¡rios Anteriores:</h3>
                <div id="todayModalCommentsList" style="max-height: 200px; overflow-y: auto;"></div>
            </div>
            
            <div class="modal-actions">
                <button id="todayModalCompleteBtn" onclick="toggleTodayTask()" class="complete-btn">Concluir</button>
                <button onclick="deleteTodayTask()" class="delete-btn">Excluir Tarefa</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
